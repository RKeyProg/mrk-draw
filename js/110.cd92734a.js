"use strict";(self["webpackChunkmrk_draw"]=self["webpackChunkmrk_draw"]||[]).push([[110],{4516:function(e,t,s){s.r(t),s.d(t,{default:function(){return k}});var i=s(3396),a=s(9242);const o=e=>((0,i.dD)("data-v-382a1900"),e=e(),(0,i.Cn)(),e),r={key:0,class:"login"},l=o((()=>(0,i._)("h4",{class:"login__title"},"Вход в аккаунт",-1))),n={class:"authorization__inputs"},u={class:"login__sub"},c={key:1,class:"register"},d=o((()=>(0,i._)("h4",{class:"login__title"},"Регистрация",-1))),g={class:"registration__inputs"},m={class:"login__sub"};function p(e,t,s,o,p,_){const h=(0,i.up)("base-icon"),w=(0,i.up)("base-input"),U=(0,i.up)("base-button");return p.isLogin?((0,i.wg)(),(0,i.iD)("div",r,[(0,i.Wm)(h,{class:"login__logo",name:"logo"}),l,(0,i._)("form",{class:"authorization",onSubmit:t[2]||(t[2]=(0,a.iM)(((...e)=>_.loginSubmit&&_.loginSubmit(...e)),["prevent"]))},[(0,i._)("div",n,[(0,i.Wm)(w,{class:"authorization__input",modelValue:p.loginUser.email,"onUpdate:modelValue":t[0]||(t[0]=e=>p.loginUser.email=e),placeholder:"Логин"},null,8,["modelValue"]),(0,i.Wm)(w,{class:"authorization__input",placeholder:"Пароль",modelValue:p.loginUser.password,"onUpdate:modelValue":t[1]||(t[1]=e=>p.loginUser.password=e),type:"password"},null,8,["modelValue"])]),(0,i.Wm)(U,{class:"authorization__btn",customType:"submit"},{default:(0,i.w5)((()=>[(0,i.Uk)("Войти")])),_:1})],32),(0,i._)("div",u,[(0,i.Wm)(U,{class:"login__registration",customType:"fill",onHandleClick:t[3]||(t[3]=e=>_.changeAuthorizationView())},{default:(0,i.w5)((()=>[(0,i.Uk)("Регистрация")])),_:1})])])):((0,i.wg)(),(0,i.iD)("div",c,[(0,i.Wm)(h,{class:"login__logo",name:"logo"}),d,(0,i._)("form",{class:"registration",onSubmit:t[6]||(t[6]=(0,a.iM)(((...e)=>_.registerSubmit&&_.registerSubmit(...e)),["prevent"]))},[(0,i._)("div",g,[(0,i.Wm)(w,{class:"registration__input",modelValue:p.registerUser.email,"onUpdate:modelValue":t[4]||(t[4]=e=>p.registerUser.email=e),placeholder:"Почта",error:e.validation.firstError("registerUser.email")},null,8,["modelValue","error"]),(0,i.Wm)(w,{class:"registration__input",placeholder:"Пароль",modelValue:p.registerUser.password,"onUpdate:modelValue":t[5]||(t[5]=e=>p.registerUser.password=e),type:"password",error:e.validation.firstError("registerUser.password")},null,8,["modelValue","error"])]),(0,i.Wm)(U,{class:"registration__btn",customType:"submit"},{default:(0,i.w5)((()=>[(0,i.Uk)("Зарегистрироваться")])),_:1})],32),(0,i._)("div",m,[(0,i.Wm)(U,{class:"login__registration",customType:"fill",onHandleClick:t[7]||(t[7]=e=>_.changeAuthorizationView())},{default:(0,i.w5)((()=>[(0,i.Uk)("Войти")])),_:1})])]))}var _=s(2780),h=s(8291),w=s(3338),U=s(8111),v=s(1672),b=s(65),f={name:"loginView",components:{BaseInput:w.Z,BaseButton:U.Z,BaseIcon:v.Z},mixins:[s(2780).jB],validators:{"registerUser.email"(e){return _.cX.value(e).required("Введите email").email("Некорректный формат")},"registerUser.password"(e){return _.cX.value(e).required("Введите пароль").minLength(6,"Минимум 6 символов")}},data(){return{loginUser:{email:"",password:""},registerUser:{email:"",password:""},isLogin:!0}},methods:{...(0,b.nv)({showTooltip:"tooltips/show",login:"user/login",setProjects:"user/setProjects"}),async loginSubmit(){try{const e=await h.Z.post("/login",this.loginUser);this.login(e.data.user);const t=e.data.projects.map((({id:e,title:t,DBSheme:s,activity:i})=>({id:e,title:t,DBSheme:s,activity:new Date(i)})));this.setProjects(t);const s=e.data.token;localStorage.setItem("token",s),h.Z.defaults.headers.Authorization=`Bearer ${s}`,this.$router.replace("/")}catch(e){this.showTooltip({text:e.response.data.message,type:"error"})}},async registerSubmit(){if(!1!==await this.$validate())try{const e=await h.Z.post("/register",this.registerUser);this.changeAuthorizationView(),this.showTooltip({text:e.data.message,type:"success"})}catch(e){this.showTooltip({text:e.response.data.message,type:"error"})}},changeAuthorizationView(){this.isLogin=!this.isLogin}}},y=s(89);const V=(0,y.Z)(f,[["render",p],["__scopeId","data-v-382a1900"]]);var k=V}}]);
//# sourceMappingURL=110.cd92734a.js.map